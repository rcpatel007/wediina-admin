<div id="main">
  <!-- START WRAPPER -->
  <div class="wrapper">
    <app-header></app-header>

    <section id="content">
      <!--start container-->
      <div class="container">
        <div class="section">
          <!--card stats start-->
          <div id="card-stats">
            <div class="row">
              <div class="col s12 m6 l3">
                <div class="card">
                  <div class="padding-4">
                    <div class="col s4 m4">
                      <div class="card-icon orange-back">
                        <i class="fa fa-shopping-cart"></i>
                      </div>
                    </div>
                    <div class="col s8 m8 right-align card-text-contain">
                      <p class="no-margin card-text">New Order</p>
                      <h5 class="mb-0 card-text-total">{{new_count}}</h5>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col s12 m6 l3">
                <div class="card">
                  <div class="padding-4">
                    <div class="col s4 m4">
                      <div class="card-icon green-back">
                        <i class="fa fa-user-cog"></i>
                      </div>
                    </div>
                    <div onclick="smoothScroll(document.getElementById('enquiry'))" class="col s8 m8 right-align card-text-contain">
                      <p class="no-margin card-text">New Enquiries</p>
                      <h5 class="mb-0 card-text-total">{{enquiry}}</h5>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col s12 m6 l3">
                <div class="card">
                  <div class="padding-4">
                    <div class="col s4 m4">
                      <div class="card-icon red-back">
                        <i class="fa fa-shopping-cart"></i>
                      </div>
                    </div>
                    <div class="col s8 m8 right-align card-text-contain">
                      <p class="no-margin card-text">Pending Orders</p>
                      <h5 class="mb-0 card-text-total">{{pendding}}</h5>

                    </div>
                  </div>
                </div>
              </div>
              <div class="col s12 m6 l3">
                <div class="card">
                  <div class="padding-4">
                    <div class="col s4 m4">
                      <div class="card-icon blue-back">
                        <i class="fa fa-shopping-cart"></i>
                      </div>
                    </div>
                    <div class="col s8 m8 right-align card-text-contain">
                      <p class="no-margin card-text">Completed Order </p>
                      <h5 class="mb-0 card-text-total">{{complate}}</h5>

                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
          <!--card stats end-->
          <!--DataTables example Row grouping-->
          <div class="section">
            <div class="row ">
              <div class="col s12 card mr-t-50">
                <div class="col s3 m3">
                  <div class="col s3 m3 section-icon orange-back">
                    <i class="fa fa-shopping-cart"></i>
                  </div>
                  <div class="col s9 m9 section-text">
                    New Order
                  </div>
                </div>
                <div class="col s3 right">
                    <input type="text" placeholder="Search" id="search" [(ngModel)]="term">
                  </div>
  
                <table class="display mr-t-90 striped" cellspacing="0" width="100%">
                  <thead>
                    <tr>
                      <th>NO</th>
                      <th>Name</th>
                      <th>Company</th>
                      <th>Order Date</th>
                      <th colspan="3">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngFor="let o of order |filter:term; let i=index ">
                      <ng-container *ngFor="let a of account">
                        <tr *ngIf="o.user_id == a._id">
                          <td>{{i+1}}</td>
                          <td>{{a.name}}</td>
                          <td>{{a.company_name}}</td>
                          <td>{{o.order_date}}</td>
                          <td *ngIf="o_view == true" (click)="viewOrder(o._id) " data-target="view_order" class=" modal-trigger">
                            <i class="fa fa-eye blue-text"></i>
                          </td>
                        </tr>
                      </ng-container>
                    </ng-container>
                  </tbody>
                </table>
              </div>
              <!-- Enquiries -->
              <div *ngIf="o_view == true" id="enquiry" class="col s12 card mr-t-50  ">
                <div class="col s3 m3">
                  <div class="col s3 m3 section-icon green-back">
                    <i class="fa fa-user-cog"></i>
                  </div>
                  <div class="col s9 m9 section-text">
                    New Enquiries
                  </div>
                </div>
                <table id="" class="display mr-t-90 striped" cellspacing="0" width="100%">
                  <thead>
                    <tr>
                      <th>NO</th>
                      <th>Name</th>
                      <th>Company</th>
                      <th>Order Date</th>
                      <th colspan="3">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngFor="let e of enquriry_data; let i=index ">
                      <ng-container *ngFor="let a of account">
                        <tr *ngIf="e.user_id == a._id">
                          <td></td>
                          <td>{{i+1}}</td>
                          <td>{{a.name}}</td>
                          <td>{{a.company_name}}</td>
                          <td>{{e.order_date}}</td>

                          <td *ngIf="o_view == true" (click)="viewOrder(o._id) " data-target="view_order" class=" modal-trigger">
                            <i class="fa fa-eye blue-text"></i>
                          </td>
                        </tr>
                      </ng-container>
                    </ng-container>
                  </tbody>
                </table>
              </div>
              <!-- Enquiries end -->
            </div>
          </div>
        </div>
      </div>
      <!--end container-->
    </section>
  </div>
</div>


<div id="view_order" class="modal">
  <div class="modal-content">
    <div class="col s12">
      <h5> Product Details</h5>
    </div>
    <div class="col s12">
      <table id="" class="display mr-t-90 striped" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Name</th>
            <th>Qty</th>
            <th>Price</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of product_details">
            <td>{{p.prod_name}}</td>
            <td>{{p.qty}}</td>
            <td>{{p.price}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
<script>
  // $(document).ready(function () {
  //   // the "href" attribute of the modal trigger must specify the modal ID that wants to be triggered
  //   $('.modal').modal();
  // });


  window.smoothScroll = function (target) {
    var scrollContainer = target;
    do { //find scroll container
      scrollContainer = scrollContainer.parentNode;
      if (!scrollContainer) return;
      scrollContainer.scrollTop += 1;
    } while (scrollContainer.scrollTop == 0);

    var targetY = 0;
    do { //find the top of target relatively to the container
      if (target == scrollContainer) break;
      targetY += target.offsetTop;
    } while (target = target.offsetParent);

    scroll = function (c, a, b, i) {
      i++; if (i > 30) return;
      c.scrollTop = a + (b - a) / 30 * i;
      setTimeout(function () { scroll(c, a, b, i); }, 20);
    }
    // start scrolling
    scroll(scrollContainer, scrollContainer.scrollTop, targetY, 0);
  }
</script>